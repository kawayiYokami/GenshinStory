@import "tailwindcss";

/* ============================================= */
/* Multi-Theme System Base                     */
/* ============================================= */

/* 
  This section defines the raw color palettes and the theme mapping system.
  The active theme is controlled by the `data-theme` attribute on the <html> element.
*/

:root {
  /* M3 Light Theme Raw Palette - Enhanced Contrast & Visibility */
  --m3-light-primary: #6C627A; /* Brighter blue for better visibility */
  --m3-light-on-primary: #FFFFFF; /* Pure white for maximum contrast */
  --m3-light-primary-container: #E0E0E0; /* Light blue container */
  --m3-light-on-primary-container: #1E40AF; /* Dark blue text on container */
  --m3-light-secondary: #555555; /* Darkened from #666666 */
  --m3-light-on-secondary: #FFFFFF;
  --m3-light-secondary-container: #D8CEE8; /* Darkened from #E8DEF8 */
  --m3-light-on-secondary-container: #0D091B; /* Darkened from #1D192B */
  --m3-light-tertiary: #6D4250; /* Darkened from #7D5260 */
  --m3-light-on-tertiary: #FFFFFF;
  --m3-light-tertiary-container: #EFC8D4; /* Darkened from #FFD8E4 */
  --m3-light-on-tertiary-container: #21010D; /* Darkened from #31111D */
  --m3-light-error: #9B1610; /* Darkened from #B3261E */
  --m3-light-on-error: #FFFFFF;
  --m3-light-error-container: #E9CECC; /* Darkened from #F9DEDC */
  --m3-light-on-error-container: #310006; /* Darkened from #410E0B */
  --m3-light-background: #F7F7F7;
  --m3-light-on-background: #000000; /* Pure black for maximum contrast */
  --m3-light-surface: #FFFFFF;
  --m3-light-on-surface: #000000; /* Pure black for maximum contrast */
  --m3-light-surface-variant: #E0E0E0; /* Darkened from #EAEAEA */
  --m3-light-on-surface-variant: #333333; /* Darkened from #666666 */
  --m3-light-outline: #B2B2B2; /* Darkened from #C2C2C2 */
  --color-m3-border-soft: rgba(0, 0, 0, 0.12);
  
  /* Enhanced Color Hierarchy */
  --m3-light-surface-1: #FFFFFF;
  --m3-light-surface-2: #F9F9F9;
  --m3-light-surface-3: #F2F2F2;
  --m3-light-elevation-1: 0 1px 2px rgba(0, 0, 0, 0.1);
  --m3-light-elevation-2: 0 2px 4px rgba(0, 0, 0, 0.15);
  --m3-light-elevation-3: 0 4px 8px rgba(0, 0, 0, 0.2);
  
  /* M3 Dark Theme Raw Palette - Enhanced Visibility */
  --m3-dark-primary: #B88BF3; /* Brighter blue for better visibility */
  --m3-dark-on-primary: #FFFFFF; /* Pure white for maximum contrast */
  --m3-dark-primary-container: #191A21; /* Darker blue for containers */
  --m3-dark-on-primary-container: #FFFFFF; /* Pure white */
  --m3-dark-secondary: #D4CAE4; /* Softer purple */
  --m3-dark-on-secondary: #241E32; /* Softer dark purple */
  --m3-dark-secondary-container: #443E52; /* Softer container */
  --m3-dark-on-secondary-container: #E8DEF8; /* Original soft purple */
  --m3-dark-tertiary: #F8C8D8; /* Softer pink */
  --m3-dark-on-tertiary: #3A1122; /* Softer dark pink */
  --m3-dark-tertiary-container: #5A3B48; /* Softer container */
  --m3-dark-on-tertiary-container: #FFD8E4; /* Original soft pink */
  --m3-dark-error: #FFB4AB; /* Keep for good contrast */
  --m3-dark-on-error: #7A000A; /* Softer red */
  --m3-dark-error-container: #9A000A; /* Softer container */
  --m3-dark-on-error-container: #FFD8D8; /* Soft error text */
  --m3-dark-background: #21222C; /* Standard dark background */
  --m3-dark-on-background: #EEEEEE; /* Soft white (93% white) */
  --m3-dark-surface: #282A36; /* Standard surface */
  --m3-dark-on-surface: #EEEEEE; /* Soft white */
  --m3-dark-surface-variant: #3C3D51; /* Softer surface variant */
  --m3-dark-on-surface-variant: #D0D0D0; /* Soft gray (82% white) - 7.2:1 contrast */
  --m3-dark-outline: #8A8A8A; /* Softer outline */
  --m3-dark-shadow: rgba(255, 255, 255, 0.12);

  /* Genshin Light Theme - New Color Palette with Depth and Harmony */
  --genshin-light-bg-primary: #DACECE; /* Lightest - Soft pinkish gray (background) */
  --genshin-light-bg-secondary: #3C3C3C; /* Dark gray for contrast elements */
  --genshin-light-surface: #E8E0D9; /* Much lighter and less pink - Soft warm gray (surface) */
  --genshin-light-surface-variant: #E9A9A7; /* Darker - Muted rose (surface variant) */
  --genshin-light-text-primary: #372325; /* Deep burgundy for primary text */
  --genshin-light-text-secondary: #FFFFFF;
  --genshin-light-accent-primary: #B14141; /* Rich red - Primary accent */
  --genshin-light-accent-secondary: #3C3C3C; /* Dark gray - Secondary accent */
  --genshin-light-error: #B14141; /* Error color matching primary accent */
  --genshin-light-outline: #CA6E73; /* Muted rose outline */
}

/* --------------------------------------------- */
/* Theme Mapping                                 */
/* --------------------------------------------- */

[data-theme="m3-light"] {
  --sys-primary: var(--m3-light-primary);
  --sys-on-primary: var(--m3-light-on-primary);
  --sys-primary-container: var(--m3-light-primary-container);
  --sys-on-primary-container: var(--m3-light-on-primary-container);
  --sys-secondary: var(--m3-light-secondary);
  --sys-on-secondary: var(--m3-light-on-secondary);
  --sys-secondary-container: var(--m3-light-secondary-container);
  --sys-on-secondary-container: var(--m3-light-on-secondary-container);
  --sys-tertiary: var(--m3-light-tertiary);
  --sys-on-tertiary: var(--m3-light-on-tertiary);
  --sys-tertiary-container: var(--m3-light-tertiary-container);
  --sys-on-tertiary-container: var(--m3-light-on-tertiary-container);
  --sys-error: var(--m3-light-error);
  --sys-on-error: var(--m3-light-on-error);
  --sys-error-container: var(--m3-light-error-container);
  --sys-on-error-container: var(--m3-light-on-error-container);
  --sys-background: var(--m3-light-background);
  --sys-on-background: var(--m3-light-on-background);
  --sys-surface: var(--m3-light-surface);
  --sys-on-surface: var(--m3-light-on-surface);
  --sys-surface-variant: var(--m3-light-surface-variant);
  --sys-on-surface-variant: var(--m3-light-on-surface-variant);
  --sys-outline: var(--m3-light-outline);
  --sys-shadow: var(--color-shadow); /* Default to black shadow */
}

[data-theme="m3-dark"] {
  --sys-primary: var(--m3-dark-primary);
  --sys-on-primary: var(--m3-dark-on-primary);
  --sys-primary-container: var(--m3-dark-primary-container);
  --sys-on-primary-container: var(--m3-dark-on-primary-container);
  --sys-secondary: var(--m3-dark-secondary);
  --sys-on-secondary: var(--m3-dark-on-secondary);
  --sys-secondary-container: var(--m3-dark-secondary-container);
  --sys-on-secondary-container: var(--m3-dark-on-secondary-container);
  --sys-tertiary: var(--m3-dark-tertiary);
  --sys-on-tertiary: var(--m3-dark-on-tertiary);
  --sys-tertiary-container: var(--m3-dark-tertiary-container);
  --sys-on-tertiary-container: var(--m3-dark-on-tertiary-container);
  --sys-error: var(--m3-dark-error);
  --sys-on-error: var(--m3-dark-on-error);
  --sys-error-container: var(--m3-dark-error-container);
  --sys-on-error-container: var(--m3-dark-on-error-container);
  --sys-background: var(--m3-dark-background);
  --sys-on-background: var(--m3-dark-on-background);
  --sys-surface: var(--m3-dark-surface);
  --sys-on-surface: var(--m3-dark-on-surface);
  --sys-surface-variant: var(--m3-dark-surface-variant);
  --sys-on-surface-variant: var(--m3-dark-on-surface-variant);
  --sys-outline: var(--m3-dark-outline);
  --sys-shadow: var(--m3-dark-shadow); /* White shadow for dark theme */
}

[data-theme="genshin-light"] {
  /* Harmonized Genshin theme with regional color accents */
  --sys-primary: var(--genshin-light-accent-primary); /* #B14141 - Rich red */
  --sys-on-primary: #FFFFFF; /* White text on red for maximum contrast */
  --sys-primary-container: var(--genshin-light-surface-variant); /* #CA6E73 - Muted rose */
  --sys-on-primary-container: #FFFFFF; /* White text for better readability */
  --sys-secondary: var(--genshin-light-accent-secondary); /* #3C3C3C - Dark gray */
  --sys-on-secondary: #FFFFFF;
  --sys-secondary-container: var(--genshin-light-surface); /* #E9A9A7 - Soft coral */
  --sys-on-secondary-container: var(--genshin-light-text-primary); /* #372325 - Deep burgundy */
  --sys-tertiary: var(--genshin-light-surface); /* #E9A9A7 - Soft coral */
  --sys-on-tertiary: var(--genshin-light-text-primary); /* #372325 - Deep burgundy */
  --sys-tertiary-container: var(--genshin-light-bg-primary); /* #DACECE - Light pinkish gray */
  --sys-on-tertiary-container: var(--genshin-light-text-primary); /* #372325 - Deep burgundy */
  --sys-error: var(--genshin-light-error); /* #B14141 - Matching primary accent */
  --sys-on-error: #FFFFFF;
  --sys-error-container: #F9DEDC; /* Standard error container for consistency */
  --sys-on-error-container: #410E0B;
  --sys-background: var(--genshin-light-bg-primary);      /* #DACECE - 最浅粉色灰 */
  --sys-on-background: var(--genshin-light-text-primary);
  --sys-surface: var(--genshin-light-surface);           /* #E9A9A7 - 中间珊瑚粉 */
  --sys-on-surface: var(--genshin-light-text-primary);
  --sys-surface-variant: var(--genshin-light-surface-variant); /* #CA6E73 - 最深玫瑰色 */
  --sys-on-surface-variant: var(--genshin-light-text-primary);
  --sys-outline: var(--genshin-light-outline);
  --sys-shadow: rgba(198, 162, 115, 0.2); /* Gold-tinted shadow */
}


@theme {
  /* System Colors -> Tailwind Theme Tokens */
  --color-primary: var(--sys-primary);
  --color-on-primary: var(--sys-on-primary);
  --color-primary-container: var(--sys-primary-container);
  --color-on-primary-container: var(--sys-on-primary-container);
  --color-secondary: var(--sys-secondary);
  --color-on-secondary: var(--sys-on-secondary);
  --color-secondary-container: var(--sys-secondary-container);
  --color-on-secondary-container: var(--sys-on-secondary-container);
  --color-tertiary: var(--sys-tertiary);
  --color-on-tertiary: var(--sys-on-tertiary);
  --color-tertiary-container: var(--sys-tertiary-container);
  --color-on-tertiary-container: var(--sys-on-tertiary-container);
  --color-error: var(--sys-error);
  --color-on-error: var(--sys-on-error);
  --color-error-container: var(--sys-error-container);
  --color-on-error-container: var(--sys-on-error-container);
  --color-background: var(--sys-background);
  --color-on-background: var(--sys-on-background);
  --color-surface: var(--sys-surface);
  --color-on-surface: var(--sys-on-surface);
  --color-surface-variant: var(--sys-surface-variant);
  --color-on-surface-variant: var(--sys-on-surface-variant);
  --color-outline: var(--sys-outline);
  --color-shadow: var(--sys-shadow);

  /* Enhanced Color Hierarchy */
  --color-surface-1: var(--m3-light-surface-1);
  --color-surface-2: var(--m3-light-surface-2);
  --color-surface-3: var(--m3-light-surface-3);
  --color-elevation-1: var(--m3-light-elevation-1);
  --color-elevation-2: var(--m3-light-elevation-2);
  --color-elevation-3: var(--m3-light-elevation-3);

  /* Spacing */
  --spacing-gap: 8px;

  /* Transition Timing Function */
  --ease-short: 0.2s ease-out;
  --ease-medium: 0.3s ease-out;
  --ease-long: 0.4s ease-out;
}

@layer base {
  * {
    box-sizing: border-box;
  }

  html,
  body {
    font-size: 15px;
    height: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden;
    font-family: "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    background-color: var(--color-background);
    color: var(--color-on-background);
  }

  /* Enhanced Focus Visibility for Accessibility */
  *:focus-visible {
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
    border-radius: 2px;
  }

  /* High Contrast Mode Support */
  @media (prefers-contrast: high) {
    :root {
      --m3-light-on-surface: #000000;
      --m3-light-on-surface-variant: #222222;
      --m3-light-outline: #000000;
    }
    
    [data-theme="genshin-light"] {
      --sys-on-surface: #000000;
      --sys-on-surface-variant: #222222;
      --sys-outline: #000000;
    }
  }

  /* Reduced Motion Support */
  @media (prefers-reduced-motion: reduce) {
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }

  /* Custom scrollbar styles */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 4px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: rgba(0, 0, 0, 0.3);
  }

  /* --- Unified Prose Styling Container --- */
  .prose-styling-container,
  .markdown-body {
    background-color: transparent !important;
    font-size: 16px;
    line-height: 1.75;
    color: var(--color-on-surface-variant);
  }

  .prose-styling-container h1, .markdown-body h1,
  .prose-styling-container h2, .markdown-body h2,
  .prose-styling-container h3, .markdown-body h3,
  .prose-styling-container h4, .markdown-body h4,
  .prose-styling-container h5, .markdown-body h5,
  .prose-styling-container h6, .markdown-body h6 {
    color: var(--color-on-surface);
    border-bottom-color: var(--color-outline);
    margin-top: 1.5em;
    margin-bottom: 0.5em;
    font-weight: 600;
  }
  
  .prose-styling-container h1, .markdown-body h1 { font-size: 2.25em; padding-bottom: 0.3em; border-bottom-width: 1px; }
  .prose-styling-container h2, .markdown-body h2 { font-size: 1.75em; padding-bottom: 0.3em; border-bottom-width: 1px; }
  .prose-styling-container h3, .markdown-body h3 { font-size: 1.5em; }
  .prose-styling-container h4, .markdown-body h4 { font-size: 1.25em; }

  .prose-styling-container p, .markdown-body p {
    margin-bottom: 1em;
  }

  .prose-styling-container a, .markdown-body a {
    color: var(--color-primary);
    text-decoration: none;
  }
  .prose-styling-container a:hover, .markdown-body a:hover {
    text-decoration: underline;
  }

  .prose-styling-container code, .markdown-body code {
    font-family: monospace;
    padding: 0.2em 0.4em;
    margin: 0;
    font-size: 85%;
    border-radius: 6px;
    background-color: var(--color-surface-variant);
    color: var(--color-on-surface-variant);
  }

  .prose-styling-container pre, .markdown-body pre {
    padding: 16px;
    overflow: auto;
    font-size: 85%;
    line-height: 1.45;
    border-radius: 6px;
    background-color: var(--color-surface-variant);
  }

  .prose-styling-container pre code, .markdown-body pre code {
    padding: 0;
    margin: 0;
    font-size: 100%;
    background-color: transparent;
    border-radius: 0;
  }

  .prose-styling-container blockquote, .markdown-body blockquote {
    margin-left: 0;
    padding-left: 1em;
    border-left: 0.25em solid var(--color-outline);
    color: var(--color-on-surface-variant);
    font-style: italic;
  }

  .prose-styling-container ul, .markdown-body ul,
  .prose-styling-container ol, .markdown-body ol {
    padding-left: 2em;
    margin-bottom: 1em;
  }
  
  .prose-styling-container li, .markdown-body li {
    margin-bottom: 0.25em;
  }
}

@layer components {
  /* All component styles below will now use the new system variables */
  /* --- Form Elements --- */
  .form-input, .form-select {
      @apply p-2 rounded border bg-surface-variant text-on-surface-variant w-full;
      border-color: var(--color-outline);
    }

  /* --- Switch (Toggle) --- */
  .switch {
    @apply relative inline-block w-12 h-7;
  }
  .switch input {
    @apply opacity-0 w-0 h-0;
  }
  .slider {
    @apply absolute cursor-pointer top-0 left-0 right-0 bottom-0 bg-surface-variant transition-all duration-400;
  }
  .slider:before {
    @apply absolute h-5 w-5 left-1 bottom-1 bg-outline transition-all duration-400;
    content: "";
  }
  input:checked + .slider {
    @apply bg-primary;
  }
  input:checked + .slider:before {
    @apply bg-white transform translate-x-5;
  }
  .slider.round {
    @apply rounded-full;
  }
  .slider.round:before {
    @apply rounded-full;
  }

  /* --- Chat Input Panel --- */
  .chat-input-panel {
      @apply p-4 border-t;
      border-color: var(--color-outline);
    }
  .chat-textarea {
      @apply w-full p-4 rounded-3xl border bg-surface resize-none font-sans text-on-surface transition-all duration-200;
      border-color: var(--color-outline);
    }
  .chat-textarea:focus {
    @apply outline-hidden border-primary shadow-[0_0_0_2px_var(--color-primary-container)];
  }
  .send-button {
    @apply w-10 h-10 rounded-full bg-primary text-on-primary border-none flex items-center justify-center cursor-pointer;
  }
  .send-button:hover {
    @apply bg-primary-container text-on-primary-container;
  }
  .send-button:disabled {
    @apply bg-surface-variant text-on-surface-variant cursor-not-allowed;
  }
  .send-button.stop-button {
    @apply bg-error text-on-error;
  }
  .send-button.stop-button:hover {
    @apply bg-error-container text-on-error-container;
  }

  /* --- Message Bubble --- */
  .message-bubble {
    @apply max-w-4xl w-full mx-auto px-4;
  }
  .message-bubble.user {
    @apply bg-transparent text-on-surface-variant;
  }
  .message-bubble.assistant {
    @apply bg-transparent text-on-surface-variant;
  }
  .message-bubble .content {
    @apply p-3 rounded-lg;
  }
  .retry-button {
      @apply mt-2 bg-transparent border text-on-surface-variant px-2.5 py-1 rounded-md text-sm;
      border-color: var(--color-outline);
    }
  .retry-button:hover {
      @apply bg-primary-container text-on-primary-container;
      border-color: var(--color-primary);
    }

  /* --- Agent Selector Modal --- */
  .modal-content {
    @apply bg-surface p-5;
  }
  .modal-header {
      @apply flex justify-between items-center border-b pb-2.5;
      border-color: var(--color-outline);
    }
  .modal-title {
    @apply m-0 text-on-surface;
  }
  .close-button {
    @apply cursor-pointer text-on-surface-variant;
  }
  .agent-list-button {
      @apply w-full text-left p-3 bg-transparent border rounded-lg cursor-pointer text-on-surface transition-colors duration-200;
      border-color: var(--color-outline);
    }
  .agent-list-button:hover {
      @apply bg-surface-variant;
      border-color: var(--color-primary);
    }
  .agent-list-button.active {
      @apply bg-primary-container text-on-primary-container font-bold;
      border-color: var(--color-primary);
    }

  /* --- Reference Dropdown --- */
  .reference-dropdown {
      @apply absolute bottom-full mb-2 w-full max-h-60 overflow-y-auto bg-surface border rounded-xl shadow-md z-10;
      border-color: var(--color-outline);
    }
  .reference-item {
    @apply p-3 cursor-pointer text-on-surface mb-1;
  }
  .reference-item:hover {
    @apply bg-surface-variant;
  }
  .reference-item.active {
    @apply bg-primary-container text-on-primary-container;
  }

  /* --- Session History Panel --- */
  .session-item {
    @apply p-3 border border-transparent rounded-lg cursor-pointer;
  }
  .session-item:hover {
    @apply bg-surface-variant;
  }
  .session-item.active {
      @apply bg-primary-container text-on-primary-container font-bold;
      border-color: var(--color-primary);
    }
  .session-name {
    @apply font-semibold text-primary text-sm;
  }
  .session-item.active .session-name {
    @apply text-on-primary-container;
  }
  .session-details {
    @apply text-sm text-on-surface-variant;
  }
  .delete-button {
    @apply bg-transparent border-none text-on-surface-variant cursor-pointer;
  }
  .delete-button:hover {
    @apply bg-error-container text-on-error-container;
  }

  /* --- Tool Call Card --- */
  .tool-call-card {
      @apply border rounded-lg my-2 bg-surface-variant text-on-surface-variant text-sm;
      border-color: var(--color-outline);
    }
  .tool-call-header {
      @apply flex items-center gap-2 p-2 border-b;
      border-color: var(--color-outline);
    }
  .tool-name {
    @apply font-semibold text-primary flex-shrink-0;
  }

  /* --- Header Action Button --- */
  .btn-header-action {
    @apply p-1.5 rounded-lg cursor-pointer font-medium transition-colors duration-200 bg-transparent text-on-surface-variant border-none hover:bg-surface-variant disabled:opacity-50 disabled:cursor-not-allowed;
  }
  .btn-header-action svg {
    @apply w-5 h-5;
  }
}
/* Enhanced Interactive States */
@layer components {
  /* Enhanced Button Hover Effects */
  .send-button {
    @apply w-10 h-10 rounded-full bg-primary text-on-primary border-none flex items-center justify-center cursor-pointer transition-all duration-200;
  }
  .send-button:hover {
    @apply bg-primary/90 transform scale-105 shadow-md;
  }
  .send-button:active {
    @apply bg-primary/80 transform scale-95;
  }
  .send-button:disabled {
    @apply bg-surface-variant text-on-surface-variant cursor-not-allowed transform-none;
  }
  .send-button.stop-button {
    @apply bg-error text-on-error;
  }
  .send-button.stop-button:hover {
    @apply bg-error/90 transform scale-105;
  }

  /* Enhanced Form Input Interactions */
  .form-input, .form-select {
    @apply p-2 rounded border bg-surface-variant text-on-surface-variant w-full transition-colors duration-200;
    border-color: var(--color-outline);
  }
  .form-input:focus, .form-select:focus {
    @apply border-primary shadow-[0_0_0_2px_var(--color-primary-container)];
  }
  .form-input:hover, .form-select:hover {
    @apply border-primary/70;
  }

  /* Enhanced List Item Interactions */
  .agent-list-button, .session-item, .reference-item {
    transition: all var(--ease-medium);
  }
  .agent-list-button:hover, .session-item:hover, .reference-item:hover {
    transform: translateY(-1px);
    box-shadow: var(--color-elevation-1);
  }

  /* Enhanced Focus States */
  .btn-header-action:focus-visible,
  .send-button:focus-visible,
  .form-input:focus-visible,
  .form-select:focus-visible,
  .agent-list-button:focus-visible,
  .session-item:focus-visible,
  .reference-item:focus-visible {
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
  }

  /* Enhanced Active States */
  .agent-list-button.active,
  .session-item.active,
  .reference-item.active {
    @apply transform scale-[1.02] shadow-md;
  }
}

/* Reduced Motion Support */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    transform: none !important;
  }
}

/* High Contrast Mode Enhancements */
@media (prefers-contrast: high) {
  :root {
    --m3-light-outline: #000000;
    --m3-light-on-surface-variant: #000000;
    --m3-dark-outline: #FFFFFF;
    --m3-dark-on-surface-variant: #FFFFFF;
  }
  
  .form-input, .form-select {
    border-width: 2px;
  }
  
  .btn-primary, .btn-secondary {
    border: 2px solid currentColor;
  }

  /* Enhanced dark theme for high contrast */
  [data-theme="m3-dark"] {
    --sys-outline: #FFFFFF;
    --sys-on-surface-variant: #FFFFFF;
  }
}

/* Dark theme specific accessibility enhancements */
@media (prefers-color-scheme: dark) {
  /* Ensure focus indicators are visible in dark mode */
  *:focus-visible {
    outline-color: #4A90E2; /* Brighter blue for better visibility in dark mode */
  }

  /* Enhance text selection visibility */
  ::selection {
    background-color: rgba(74, 144, 226, 0.3);
    color: #FFFFFF;
  }

  /* Improve scrollbar visibility in dark mode */
  ::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  ::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.5);
  }
}

/* Reduced transparency for better readability */
@media (prefers-reduced-transparency: reduce) {
  .modal-content,
  .reference-dropdown,
  .tool-call-card {
    background-color: var(--color-surface) !important;
    backdrop-filter: none !important;
  }
}